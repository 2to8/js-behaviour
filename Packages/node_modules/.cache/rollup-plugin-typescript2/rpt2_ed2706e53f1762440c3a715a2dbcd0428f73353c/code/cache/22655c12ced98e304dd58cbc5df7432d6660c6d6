{"code":"import { Base } from \"csharp\";\r\n/**\r\n * 组件接口，回调时机同unity的mono behaviour\r\n */\r\nexport class Component {\r\n    BindProperty(instanceId) {\r\n        console.log(`instanceId = ${instanceId}`);\r\n        this.behaviour = Base.Runtime.JsBehaviourMgr.Instance.Get(instanceId);\r\n        this.compInfo = this[\"componentInfo\"];\r\n        for (let propName in this.compInfo.properties) {\r\n            const propInfo = this.compInfo.properties[propName];\r\n            this[propInfo.name] = this.GetPropertyValue(propInfo);\r\n        }\r\n    }\r\n    UnbindProperty() {\r\n        for (let propName in this.compInfo.properties) {\r\n            const propInfo = this.compInfo.properties[propName];\r\n            this[propInfo.name] = undefined;\r\n        }\r\n    }\r\n    GetPropertyValue(propInfo) {\r\n        switch (propInfo.type) {\r\n            case \"System.Single\":\r\n                return propInfo.isArray ?\r\n                    this.ConvertTypedListToArray(this.behaviour.JsComponentProp.GetFloatList(propInfo.name)) :\r\n                    this.behaviour.JsComponentProp.GetFloat(propInfo.name);\r\n            case \"System.String\":\r\n                return propInfo.isArray ?\r\n                    this.ConvertTypedListToArray(this.behaviour.JsComponentProp.GetStringList(propInfo.name)) :\r\n                    this.behaviour.JsComponentProp.GetString(propInfo.name);\r\n            case \"System.Int32\":\r\n            case \"System.UInt32\":\r\n            case \"System.Int16\":\r\n            case \"System.UInt16\":\r\n                return propInfo.isArray ?\r\n                    this.ConvertTypedListToArray(this.behaviour.JsComponentProp.GetIntList(propInfo.name)) :\r\n                    this.behaviour.JsComponentProp.GetInt(propInfo.name);\r\n            case \"System.Int64\":\r\n            case \"System.UInt64\":\r\n                return propInfo.isArray ?\r\n                    this.ConvertTypedListToArray(this.behaviour.JsComponentProp.GetLongList(propInfo.name)) :\r\n                    this.behaviour.JsComponentProp.GetLong(propInfo.name);\r\n            case \"UnityEngine.Vector2\":\r\n                return propInfo.isArray ?\r\n                    this.ConvertTypedListToArray(this.behaviour.JsComponentProp.GetVector2List(propInfo.name)) :\r\n                    this.behaviour.JsComponentProp.GetVector2(propInfo.name);\r\n            case \"UnityEngine.Vector3\":\r\n                return propInfo.isArray ?\r\n                    this.ConvertTypedListToArray(this.behaviour.JsComponentProp.GetVector3List(propInfo.name)) :\r\n                    this.behaviour.JsComponentProp.GetVector3(propInfo.name);\r\n            default:\r\n                if (this.behaviour.JsComponentProp.IsUEObject(propInfo.type)) {\r\n                    return propInfo.isArray ?\r\n                        this.ConvertTypedListToArray(this.behaviour.JsComponentProp.GetUEObjectList(propInfo.name)) :\r\n                        this.behaviour.JsComponentProp.GetUEObject(propInfo.name);\r\n                }\r\n                return undefined;\r\n        }\r\n    }\r\n    ConvertTypedListToArray(list) {\r\n        let array = [];\r\n        if (list?.Data == null) {\r\n            return array;\r\n        }\r\n        for (let i = 0; i < list?.Data.Count; ++i) {\r\n            array.push(list.Data.get_Item(i));\r\n        }\r\n        return array;\r\n    }\r\n    compInfo;\r\n    behaviour;\r\n}\r\n//# sourceMappingURL=component-base.js.map","references":["/mnt/f/CubeWars/samples/js-behaviour/Packages/typings/csharp/index.d.ts","/mnt/f/CubeWars/samples/js-behaviour/Packages/src/component/component-info-mgr.ts"],"map":"{\"version\":3,\"file\":\"component-base.js\",\"sourceRoot\":\"\",\"sources\":[\"../../../../../src/component/component-base.ts\"],\"names\":[],\"mappings\":\"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\"}"}
